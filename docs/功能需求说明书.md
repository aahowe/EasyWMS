# EasyWMS 功能需求说明书

**版本：** V1.0  
**项目名称：** 简易仓库管理系统 (EasyWMS)  
**更新日期：** 2025-12-22

---

## 文档修订历史

| 修改日期 | 版本 | 责任人 | 修改内容 |
| --- | --- | --- | --- |
| 2025/12/18 | V0.1 | 池芳敏 | 初始文档创建 |
| 2025/12/19 | V0.5 | 詹锦贤 | 完成功能模块详细划分 |
| 2025/12/20 | V1.0 | 王昊 | 文档校对与定稿 |
| 2025/12/22 | V1.1 | 系统 | 整合并优化文档结构 |

---

## 1. 项目概述

### 1.1 项目背景

针对中小企业在物资管理中存在的核心痛点：
- **物资档案混乱**：缺乏统一的物资编码和规格管理
- **账实不符**：库存数据与实际库存不一致
- **部门领用无记录**：物资消耗无法追溯到具体部门
- **采购流程不规范**：缺乏审批流程和供应商管理

本项目旨在开发一套轻量级、高并发的仓库管理系统，通过数字化手段实现物资的全生命周期管理。

### 1.2 项目目标

**功能目标**
- 构建包含基础档案管理、完整供应链流程（采购-入库-出库）及财务暂估支持的闭环系统
- 实现物资从需求提出到入库，再到消耗出库的全流程数字化管理

**技术目标**
- 基于 Go (Gin+GORM) 后端架构与 Vue 3 前端对接
- 确保核心业务（库存扣减）的事务一致性和并发安全
- 支持"冷启动"能力（期初数据录入与物资定义）

**可用性目标**
- 界面简洁直观，操作便捷
- 支持多角色权限管理
- 提供实时库存预警和统计报表

### 1.3 术语与缩写

| 术语 | 说明 |
| --- | --- |
| SKU | Stock Keeping Unit，库存量单位，物资的唯一标识码 |
| 暂估入库 | 货物已到但发票未到，标记为"未结算"状态的入库方式 |
| RBAC | Role-Based Access Control，基于角色的访问控制 |
| PO单 | Purchase Order，采购订单 |
| 悲观锁 | 数据库锁机制，用于防止并发操作导致的数据不一致 |

---

## 2. 用户角色定义

系统定义四类职能角色，确保业务流转的真实性：

| 角色代码 | 角色名称 | 核心职责 | 典型操作 |
| --- | --- | --- | --- |
| ADMIN | 系统管理员 | 系统配置与基础数据管理 | 用户管理、物资档案建立、期初库存录入、部门架构维护、采购审批 |
| BUYER | 采购专员 | 采购业务管理 | 维护供应商信息、发起采购申请、生成采购订单 |
| W_MGR | 仓库管理员 | 仓储作业管理 | 验收入库（含暂估）、审核出库、库存盘点与修正 |
| STAFF | 部门员工 | 物资领用 | 查询库存、发起物资领用申请 |

---

## 3. 功能模块详细说明

### 3.1 基础数据管理模块

**模块编号：** BM-01  
**负责角色：** 系统管理员

#### 3.1.1 物资档案管理

**功能描述**  
管理系统中所有物资的基础信息，是所有业务单据的数据源。

**核心功能**
1. **物资信息维护**
   - 新增物资：录入SKU编码、名称、规格型号、计量单位、所属分类
   - 修改物资：更新物资基础信息
   - 停用物资：对不再使用的物资进行停用标记（不可物理删除）
   - 查询物资：支持按名称、SKU编码、分类进行检索

2. **库存预警设置**
   - 为每个物资设置预警阈值
   - 当库存低于阈值时，系统自动标红提醒

3. **物资分类管理**
   - 支持树形分类结构（如：办公用品 > 文具类 > 笔类）
   - 分类可新增、修改、删除（需检查是否有物资引用）

**业务规则**
- SKU编码必须唯一，不可重复
- 已被业务单据引用的物资不可删除，只能停用
- 物资名称、SKU编码、计量单位为必填项
- 预警阈值默认为0，可根据实际需求设置

**输入**
- 物资基础信息（SKU、名称、规格、单位、分类、预警值）

**输出**
- 物资列表（支持分页、筛选、排序）
- 低库存预警列表

#### 3.1.2 供应商管理

**功能描述**  
维护供应商基础档案，为采购订单提供标准的货源方数据。

**核心功能**
1. 新增供应商：录入名称、联系人、电话、地址
2. 修改供应商：更新供应商信息
3. 停用供应商：标记不再合作的供应商
4. 查询供应商：按名称、联系人检索

**业务规则**
- 供应商名称不可重复
- 已被采购订单引用的供应商不可删除，只能停用

#### 3.1.3 部门管理

**功能描述**  
定义企业组织架构，用于统计各部门的物资消耗。

**核心功能**
1. 新增部门：创建部门节点
2. 修改部门：更新部门名称
3. 调整层级：支持拖拽调整部门层级关系
4. 删除部门：删除无下级部门且无用户的部门

**业务规则**
- 支持树形结构，可设置父部门
- 有下级部门或关联用户的部门不可删除

#### 3.1.4 用户与权限管理

**功能描述**  
管理系统用户账号及其角色权限。

**核心功能**
1. 创建用户：设置用户名、初始密码、真实姓名、所属部门、角色
2. 修改用户：更新用户信息、调整角色
3. 重置密码：为用户重置登录密码
4. 禁用账号：停用不再使用的账号
5. 查询用户：按用户名、部门、角色检索

**业务规则**
- 用户名必须唯一
- 密码使用BCrypt加密存储
- 每个用户只能分配一个角色
- 禁用的账号无法登录系统

#### 3.1.5 期初库存录入

**功能描述**  
系统首次上线时，录入现有库存数据，完成库存数据的冷启动。

**核心功能**
1. 批量录入：为多个物资录入期初库存数量
2. 导入功能：支持Excel批量导入
3. 库位设置：指定物资存放库位
4. 初始化提交：生成期初库存记录和流水

**业务规则**
- 期初录入后，系统自动生成库存流水记录
- 期初数据录入后，物资的实时库存字段更新
- 建议在系统正式使用前完成期初录入

---

### 3.2 采购管理模块

**模块编号：** BOM-01  
**负责角色：** 采购专员、系统管理员

#### 功能描述
实现物资从需求发起到订单生成的全过程管理，包含采购申请、审核、订单生成三个环节。

#### 3.2.1 采购申请

**操作角色：** 采购专员

**业务流程**
1. 采购专员进入"采购管理"模块，点击"新建申请"
2. 从物资档案中选择所需物资（支持多选）
3. 填写每个物资的采购数量
4. 填写申请原因和期望到货日期
5. 提交申请，系统生成唯一的采购单号（PO开头）
6. 申请状态标记为"待审核"

**输入**
- 物资清单（物资ID、采购数量）
- 申请原因
- 期望到货日期

**输出**
- 采购申请单（包含单号、申请人、申请时间、物资明细）
- 状态：PENDING（待审核）

**业务规则**
- 采购数量必须大于0
- 一张采购申请可包含多个物资
- 采购单号自动生成，格式：PO + 日期 + 序号

#### 3.2.2 采购审核

**操作角色：** 系统管理员

**业务流程**
1. 管理员进入"采购审核"子模块
2. 系统显示所有待审核的采购申请
3. 管理员查看申请详情（申请人、物资清单、申请原因）
4. 执行"批准"或"驳回"操作
   - 批准：状态更新为"已批准"（APPROVED）
   - 驳回：填写驳回原因，状态更新为"已驳回"（REJECTED），通知申请人

**输入**
- 审核意见（批准/驳回）
- 驳回原因（驳回时必填）

**输出**
- 采购申请单状态更新
- 系统通知（驳回时）

**业务规则**
- 只有"待审核"状态的申请可以审核
- 驳回后，采购专员可重新提交申请
- 审核记录需保存审核人和审核时间

#### 3.2.3 采购订单生成

**操作角色：** 采购专员

**业务流程**
1. 采购专员进入"已批准申请"列表
2. 选择目标申请单，点击"生成订单"
3. 选择供应商（从供应商档案中选择）
4. 填写单价信息（可选）
5. 确认合同条款与付款方式
6. 生成正式采购订单，状态更新为"已下单"（ORDERED）

**输入**
- 供应商选择
- 单价信息（可选）

**输出**
- 正式采购订单
- 状态：ORDERED（已下单）

**业务规则**
- 只有"已批准"状态的申请可以生成订单
- 一张申请只能生成一张订单
- 订单生成后，可发送给供应商

---

### 3.3 入库管理模块

**模块编号：** BOM-02  
**负责角色：** 仓库管理员

#### 功能描述
处理货物到仓后的验收与入库操作，支持正常入库和暂估入库两种流程。

#### 3.3.1 到货验收

**业务流程**
1. 仓管员输入采购订单号或扫描条码
2. 系统显示预期到货物资清单（来自采购订单）
3. 仓管员核对实物，录入实收数量
4. 录入质量检验结果（合格/不合格）
5. 若有不合格品，记录原因并拍照
6. 提交验收记录

**输入**
- 采购订单号
- 实收数量
- 质量检验结果
- 不合格原因（如有）

**输出**
- 验收记录
- 合格物资清单（可入库）
- 不合格物资清单（需退货）

**业务规则**
- 实收数量可以小于或等于采购数量
- 只有合格的物资才能进入入库流程
- 验收记录需保存验收人和验收时间

#### 3.3.2 正常入库

**业务流程**
1. 仓管员进入入库界面，选择已验收的物资
2. 选择入库库位（存放位置）
3. 确认入库日期（默认当前日期）
4. 点击"确认入库"
5. 系统执行以下操作：
   - 增加物资的实时库存数量
   - 生成入库单据（IN开头）
   - 生成库存流水记录（类型：IN）
   - 更新采购订单状态为"已完成"（DONE）

**输入**
- 入库物资清单
- 入库库位
- 入库日期

**输出**
- 入库单据
- 库存数量更新
- 库存流水记录

**业务规则**
- 入库后，物资的stock_qty字段增加
- 入库单号自动生成，格式：IN + 日期 + 序号
- 库存流水记录变动类型为"IN"，变动数量为正数

#### 3.3.3 暂估入库

**功能描述**  
针对"货到票未到"场景，货物已到但发票未到，需要先入库但标记为"未结算"状态。

**业务流程**
1. 仓管员在入库界面勾选"暂估入库"选项
2. 填写暂估原因
3. 填写预计发票到达日期
4. 确认入库
5. 系统执行以下操作：
   - 增加物资的实时库存数量
   - 生成入库单据，标记is_temporary=1
   - 生成库存流水记录
   - 财务状态标记为"未结算"

**输入**
- 暂估标记（勾选）
- 暂估原因
- 预计发票到达日期

**输出**
- 暂估入库单据
- 库存数量更新（财务状态：未结算）

**业务规则**
- 暂估入库的物资可以正常出库使用
- 发票到达后，需要进行"暂估转正"操作
- 暂估入库单据需要特殊标识，便于财务对账

---

### 3.4 出库管理模块

**模块编号：** BOM-03  
**负责角色：** 部门员工、仓库管理员

#### 功能描述
部门员工发起领用申请，仓管员审核并执行出库，系统确保库存扣减的准确性和并发安全。

#### 3.4.1 领用申请

**操作角色：** 部门员工

**业务流程**
1. 员工进入"物资领用"界面
2. 查询可用库存（显示实时库存数量）
3. 选择需要领用的物资（支持多选）
4. 填写每个物资的领用数量
5. 填写领用用途
6. 系统校验库存是否充足
7. 提交申请，生成出库单号（OUT开头）
8. 申请状态标记为"待审核"

**输入**
- 物资清单（物资ID、领用数量）
- 领用用途
- 领用部门（自动获取申请人所属部门）

**输出**
- 领用申请单
- 状态：PENDING（待审核）

**业务规则**
- 领用数量必须大于0且不超过当前库存
- 一张领用申请可包含多个物资
- 申请人所属部门自动关联到申请单

#### 3.4.2 出库审核

**操作角色：** 仓库管理员

**业务流程**
1. 仓管员进入"出库审核"界面
2. 系统显示所有待审核的领用申请
3. 仓管员查看申请详情（申请人、部门、物资清单、用途）
4. 评估数量合理性和用途正当性
5. 执行"批准"或"驳回"操作
   - 批准：状态更新为"已批准"（APPROVED）
   - 驳回：填写驳回原因，状态更新为"已驳回"（REJECT），通知申请人

**输入**
- 审核意见（批准/驳回）
- 驳回原因（驳回时必填）

**输出**
- 领用申请单状态更新
- 系统通知（驳回时）

**业务规则**
- 只有"待审核"状态的申请可以审核
- 审核时需再次校验库存是否充足
- 审核记录需保存审核人和审核时间

#### 3.4.3 出库执行

**操作角色：** 仓库管理员

**业务流程**
1. 仓管员针对已批准的申请单点击"执行出库"
2. 扫描物资条码确认实物
3. 填写实际出库数量（可能与申请数量不同）
4. 领用人现场签字确认
5. 系统执行以下操作（事务处理）：
   - 使用悲观锁（SELECT ... FOR UPDATE）锁定物资记录
   - 扣减物资的实时库存数量
   - 生成出库流水记录（类型：OUT）
   - 更新申请单状态为"已领用"（DONE）
   - 记录实际出库时间

**输入**
- 实际出库数量
- 领用人签字确认

**输出**
- 库存扣减结果
- 出库流水记录
- 申请单状态更新

**业务规则**
- 出库操作必须在数据库事务中执行
- 使用悲观锁防止并发超卖
- 实际出库数量不能超过申请数量和当前库存
- 库存流水记录变动类型为"OUT"，变动数量为负数
- 出库后，物资的stock_qty字段减少

---

### 3.5 统计与盘点模块

**模块编号：** BOM-04  
**负责角色：** 仓库管理员、系统管理员

#### 功能描述
提供多维度的库存查询、定期的库存盘点以及统计报表生成功能，确保账实相符并辅助管理决策。

#### 3.5.1 库存查询

**业务流程**
1. 用户根据权限进入查询界面
2. 支持多维度筛选：
   - 按物资类别筛选
   - 按部门筛选（查看部门消耗）
   - 按库位筛选
   - 按库存状态筛选（正常/预警/缺货）
3. 显示实时库存快照
4. 支持导出Excel

**输入**
- 查询筛选条件

**输出**
- 库存列表（物资名称、SKU、库存数量、预警阈值、库位）
- 低库存预警列表（库存低于阈值的物资）

**业务规则**
- 库存数据实时更新
- 低于预警阈值的物资红字高亮显示
- 支持按库存数量排序

#### 3.5.2 统计报表

**业务流程**
1. 管理人员进入"统计报表"子模块
2. 选择报表类型：
   - 入库金额统计
   - 出库金额统计
   - 部门领用排行
   - 物资消耗趋势
3. 选择时间范围（日/周/月/自定义）
4. 生成图表（ECharts）
5. 支持导出PDF/Excel

**输入**
- 报表类型
- 时间范围

**输出**
- 统计图表（饼图、柱状图、折线图）
- 数据明细表

**业务规则**
- 数据来源于库存流水表
- 支持多维度统计分析
- 图表支持交互式查看

#### 3.5.3 库存盘点

**业务流程**

**1. 创建盘点任务**
- 仓管员创建盘点任务
- 选定盘点范围（全库/特定类别/特定库位）
- 系统生成盘点单号（CHK开头）
- 状态标记为"盘点中"（CHECKING）

**2. 录入实盘数量**
- 盘点人员线下清点实物
- 在系统中录入实盘数量
- 系统自动获取账面数量（当前库存）

**3. 生成盘点差异**
- 系统自动比对账面数量与实盘数量
- 计算差异：盈亏数量 = 实盘数量 - 账面数量
- 生成盘盈/盘亏报告

**4. 盘点调整**
- 管理员审核盘点结果
- 确认调整后，系统执行：
  - 更新物资的实时库存数量
  - 生成库存流水记录（类型：ADJUST）
  - 盘点单状态更新为"已完成"（FINISHED）

**输入**
- 盘点范围
- 实盘数量

**输出**
- 盘点单据
- 盘点差异报告
- 库存调整记录

**业务规则**
- 盘点期间，相关物资不可进行出入库操作
- 盘点差异需要审批后才能调整库存
- 库存流水记录变动类型为"ADJUST"
- 盘点记录需保存盘点人和盘点时间

---

## 4. 非功能性需求

### 4.1 性能要求

- 系统响应时间：页面加载 < 2秒，接口响应 < 500ms
- 并发用户数：支持100个并发用户同时操作
- 数据库查询：复杂查询 < 3秒
- 库存扣减操作：使用悲观锁确保并发安全

### 4.2 安全要求

- 密码加密：使用BCrypt算法加密存储
- 身份认证：使用JWT令牌进行无状态认证
- 权限控制：基于RBAC模型，不同角色有不同操作权限
- 操作审计：记录关键操作日志（登录、库存调整等）
- 数据备份：每日自动备份数据库

### 4.3 可用性要求

- 系统可用性：99%以上
- 界面友好：符合用户操作习惯，减少培训成本
- 错误提示：清晰的错误提示和操作引导
- 帮助文档：提供在线帮助文档

### 4.4 兼容性要求

- 浏览器支持：Chrome、Firefox、Edge最新版本
- 分辨率支持：1920x1080及以上
- 移动端：支持响应式布局（可选）

---

## 5. 业务规则总结

### 5.1 库存管理规则

1. 库存数量不能为负数
2. 出库时必须校验库存充足
3. 库存扣减使用悲观锁防止并发超卖
4. 所有库存变动必须记录流水
5. 库存流水不可修改和删除

### 5.2 单据流转规则

1. 采购流程：申请 → 审核 → 订单 → 入库 → 完成
2. 出库流程：申请 → 审核 → 执行 → 完成
3. 单据状态只能单向流转，不可回退
4. 已完成的单据不可修改和删除

### 5.3 权限控制规则

1. 系统管理员：拥有所有权限
2. 采购专员：只能操作采购相关功能
3. 仓库管理员：只能操作入库、出库、盘点功能
4. 部门员工：只能查询库存和发起领用申请

### 5.4 数据完整性规则

1. 物资档案是所有业务单据的基础，不可随意删除
2. 供应商、部门等基础数据被引用后不可删除
3. 外键约束确保数据关联完整性
4. 关键字段（SKU、单号）必须唯一

---

## 6. 附录

### 6.1 参考资料

[1] GB/T 8567-2006 《计算机软件文档编制规范》国家标准化管理委员会

### 6.2 文档维护

本文档由项目组维护，如有疑问或建议，请联系项目经理。

---

**文档结束**
